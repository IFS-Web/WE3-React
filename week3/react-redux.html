<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>React Redux - WE3 – React</title> <link rel="shortcut icon" href="/WE3-React/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/WE3-React/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/WE3-React/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>React Redux | WE3 – React</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="React Redux" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Unterlagen zum React-Teil des Web Engineering 3 Moduls der OST – Ostschweizer Fachhochschule" /> <meta property="og:description" content="Unterlagen zum React-Teil des Web Engineering 3 Moduls der OST – Ostschweizer Fachhochschule" /> <link rel="canonical" href="/WE3-React/week3/react-redux.html" /> <meta property="og:url" content="/WE3-React/week3/react-redux.html" /> <meta property="og:site_name" content="WE3 – React" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="React Redux" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Unterlagen zum React-Teil des Web Engineering 3 Moduls der OST – Ostschweizer Fachhochschule","headline":"React Redux","url":"/WE3-React/week3/react-redux.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/WE3-React/" class="site-title lh-tight"> WE3 – React </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/WE3-React/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/WE3-React/introduction/" class="nav-list-link">Einführung</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/WE3-React/week1/" class="nav-list-link">Woche 1</a><ul class="nav-list "><li class="nav-list-item "><a href="/WE3-React/week1/jsx.html" class="nav-list-link">JSX</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/WE3-React/week2/" class="nav-list-link">Woche 2</a><ul class="nav-list "><li class="nav-list-item "><a href="/WE3-React/week2/introduction.html" class="nav-list-link">Woche 2 - Einführung</a></li><li class="nav-list-item "><a href="/WE3-React/week2/conditionalRendering.html" class="nav-list-link">Conditional Rendering</a></li><li class="nav-list-item "><a href="/WE3-React/week2/sessionStorage.html" class="nav-list-link">Session Storage</a></li><li class="nav-list-item "><a href="/WE3-React/week2/dataloading.html" class="nav-list-link">Data Loading</a></li><li class="nav-list-item "><a href="/WE3-React/week2/reactRouter.html" class="nav-list-link">React Router</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/WE3-React/week3/" class="nav-list-link">Woche 3</a><ul class="nav-list "><li class="nav-list-item "><a href="/WE3-React/week3/introduction.html" class="nav-list-link">Woche 3 - Einführung</a></li><li class="nav-list-item "><a href="/WE3-React/week3/redux.html" class="nav-list-link">Redux</a></li><li class="nav-list-item active"><a href="/WE3-React/week3/react-redux.html" class="nav-list-link active">React Redux</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/WE3-React/testat/" class="nav-list-link">Testat</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="/WE3-React/about.html" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/WE3-React/week3/">Woche 3</a></li> <li class="breadcrumb-nav-list-item"><span>React Redux</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="react-redux"> <a href="#react-redux" class="anchor-heading" aria-labelledby="react-redux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> React Redux </h1> <p>Nun kennst du die Grundlagen von Redux und es ist an der Zeit diese in unsere BOR Applikation zu integrieren.</p> <p>React stellt spezifische Packages zur Entwicklung mit Redux zur Verfügung.</p> <h2 id="installation"> <a href="#installation" class="anchor-heading" aria-labelledby="installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Installation </h2> <p><code class="language-plaintext highlighter-rouge">npm install react-redux</code></p> <p>Dieses Package enthält die offiziellen React Binidngs für Redux.</p> <p><code class="language-plaintext highlighter-rouge">npm install @reduxjs/toolkit</code></p> <p>Das Redux Tool Kit haben wir im vorherigen Abschnitt bereits vorgestellt. Es vereinfacht die Entwicklung mit Redux.</p> <h2 id="redux-store-setup"> <a href="#redux-store-setup" class="anchor-heading" aria-labelledby="redux-store-setup"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Redux Store Setup </h2> <div> <div class="table-wrapper"><table> <tbody> <tr> <th style="border-bottom: 1px solid #ddd"> <p>Task</p> </th> </tr> <tr> <td><p>Erstelle ein neues File <code class="language-plaintext highlighter-rouge">store.js</code> mit einem vorerst leeren <strong><em>Reducer</em></strong>.</p> </td> </tr> <tr class="hint default-hidden" style="color: grey"> <td><p>Benutze die <code class="language-plaintext highlighter-rouge">configureStore</code> API des Redux Toolkits. (Siehe vorheriger Abschnitt)</p> </td> </tr> </tbody> </table></div> <div class="text-center"> <button class="check btn btn-primary" onclick="(function (btn){ var theTable = btn.parentNode.previousElementSibling; var theAnswer = theTable.getElementsByClassName('hint')[0]; theAnswer.classList.toggle('default-hidden'); }(this))"> Tips anzeigen </button> </div> </div> <p>Dieses Objekt beinhaltet den <strong>Store</strong> der BOR Applikation. Ein weiterer Vorteil des Redux Toolkits ist, dass durch diese Konfiguration die DevTools Extensions automatisch miteinbezogen werden und die Webentwicklung dadurch trivialer wird. Stelle sicher, dass du die Redux Devtool Browser Extension in deinem Browser installiert hast.</p> <p>Als zweiter Schritt soll der <strong>Store</strong> in der React Applikation als Provider eigebunden werden:</p> <div> <div class="table-wrapper"><table style="border-bottom: 1px solid #ddd"> <tbody> <tr> <th><p>Quiz</p> </th> </tr> <tr> <td><p>Wie und an welcher Stelle in der BOR Applikation, bzw. in einer React Applikation, soll der Store am Besten eingebunden werden?</p> </td> </tr> <tr class="answer default-hidden"> <td> <p>Der Redux Store enthält State einer Applikation. Dieser State wird global gehalten und sollte daher im <code class="language-plaintext highlighter-rouge">index.js</code> eigebunden werden.</p> <p>Die Einbindung wird durch die <code class="language-plaintext highlighter-rouge">Provider</code> Schnittstelle des <code class="language-plaintext highlighter-rouge">react-redux</code> Packages ermöglicht und umschliesst die <code class="language-plaintext highlighter-rouge">&lt;App&gt;</code> Komponente.</p> </td> </tr> </tbody> </table></div> <div class="text-center"> <button class="check btn btn-primary" onclick="(function (btn){ var theTable = btn.parentNode.previousElementSibling; var theAnswer = theTable.getElementsByClassName('answer')[0]; theAnswer.classList.toggle('default-hidden'); }(this))"> Antwort anzeigen </button> </div> </div> <div> <div class="table-wrapper"><table> <tbody> <tr> <th style="border-bottom: 1px solid #ddd"> <p>Task</p> </th> </tr> <tr> <td><p>Binde den <strong>Store</strong> in die BOR Applikation ein.</p> </td> </tr> <tr class="hint default-hidden" style="color: grey"> <td><p>Benutze die <code class="language-plaintext highlighter-rouge">Provider</code> API von <code class="language-plaintext highlighter-rouge">react-redux</code>.</p> </td> </tr> </tbody> </table></div> <div class="text-center"> <button class="check btn btn-primary" onclick="(function (btn){ var theTable = btn.parentNode.previousElementSibling; var theAnswer = theTable.getElementsByClassName('hint')[0]; theAnswer.classList.toggle('default-hidden'); }(this))"> Tips anzeigen </button> </div> </div> <div> <div class="table-wrapper"><table> <tbody> <tr class="solution default-hidden"> <td> <p><code class="language-plaintext highlighter-rouge">store.js</code></p> <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">configureStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@reduxjs/toolkit</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">configureStore</span><span class="p">({</span>
  <span class="na">reducer</span><span class="p">:</span> <span class="p">{},</span>
<span class="p">});</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">store</span><span class="p">;</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">index.js</code></p> <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Provider</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-redux</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">store</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./store</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">root</span> <span class="o">=</span> <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">createRoot</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">));</span>
<span class="nx">root</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">React</span><span class="p">.</span><span class="nc">StrictMode</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nc">Provider</span> <span class="na">store</span><span class="p">=</span><span class="si">{</span><span class="nx">store</span><span class="si">}</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">BrowserRouter</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">App</span> <span class="p">/&gt;</span>
      <span class="p">&lt;/</span><span class="nc">BrowserRouter</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nc">Provider</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nc">React</span><span class="p">.</span><span class="nc">StrictMode</span><span class="p">&gt;</span>
<span class="p">);</span>
</code></pre></div></div> <p>Öffne die Applikation im Browser. Der Store sollte nun in den Redux Dev Tools initialisiert sein.<br /> Unter Firefox sieht das so aus:</p> <p align="center"> <img src="img/store_init.png" alt="action_dispatch_store" /> </p> <p>Achte darauf, dass noch keine Reducer definiert sind und es deshalb zu Fehlermeldungen in der Konsole kommt.</p> </td> </tr> </tbody> </table></div> <div class="text-center"> <button class="check btn btn-success" onclick="(function (btn){ var theTable = btn.parentNode.previousElementSibling; var theAnswer = theTable.getElementsByClassName('solution')[0]; theAnswer.classList.toggle('default-hidden'); }(this))"> Lösung </button> </div> </div> <h2 id="redux-state-slice"> <a href="#redux-state-slice" class="anchor-heading" aria-labelledby="redux-state-slice"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Redux State Slice </h2> <p>Der <strong>Store</strong> ist nun erfolgreich initialisiert. Der nächste Schritt ist das Erstellen eines <strong>States</strong> und die dazugehörigen <em>puren</em> <strong><em>Reducer</em></strong>-Funktionen, um den State zu verändern.</p> <p>Um diese Funktionalität aufzuzeigen, wird ein State Slice für den angemeldeten Benutzer erstellt.</p> <div> <div class="table-wrapper"><table> <tbody> <tr> <th style="border-bottom: 1px solid #ddd"> <p>Erstellen eines Slices mit <strong><em>Aktionen</em></strong> und <strong><em>Reducer</em></strong>-Funktionen.</p> </th> </tr> <tr> <td> <p><code class="language-plaintext highlighter-rouge">./redux/loginSlice.js</code></p> <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">createSlice</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@reduxjs/toolkit</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">loginSlice</span> <span class="o">=</span> <span class="nx">createSlice</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">login</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">initialState</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">user</span><span class="p">:</span> <span class="p">{},</span>
    <span class="na">token</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">reducers</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">addUserToState</span><span class="p">:</span> <span class="p">(</span><span class="nx">state</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">action</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">user</span><span class="p">;</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="nx">action</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">token</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="na">removeUserFromState</span><span class="p">:</span> <span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">user</span><span class="p">:</span> <span class="p">{},</span> <span class="na">token</span><span class="p">:</span> <span class="dl">''</span> <span class="p">};</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">});</span>

<span class="k">export</span> <span class="kd">const</span> <span class="p">{</span> <span class="nx">addUserToState</span><span class="p">,</span> <span class="nx">removeUserFromState</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">loginSlice</span><span class="p">.</span><span class="nx">actions</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">loginReducer</span> <span class="o">=</span> <span class="nx">loginSlice</span><span class="p">.</span><span class="nx">reducer</span><span class="p">;</span>
</code></pre></div></div> <p>Der <code class="language-plaintext highlighter-rouge">loginReducer</code> muss nun der <strong>Store</strong> Konfiguration hinzugefügt werden:</p> <p><code class="language-plaintext highlighter-rouge">store.js</code></p> <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">configureStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@reduxjs/toolkit</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">loginReducer</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./redux/loginSlice</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">configureStore</span><span class="p">({</span>
  <span class="na">reducer</span><span class="p">:</span> <span class="p">{</span> <span class="na">login</span><span class="p">:</span> <span class="nx">loginReducer</span> <span class="p">},</span>
<span class="p">});</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">store</span><span class="p">;</span>
</code></pre></div></div> <p>Diese Änderungen haben nun den <strong>Store</strong> mit einem <em>LoginSlice</em> erweitert. Überprüfe in deinem Redux Browser Dev Tool, dass ein initiales <code class="language-plaintext highlighter-rouge">login</code>-Objekt vorhanden ist.</p> </td> </tr> <tr class="hint default-hidden" style="color: grey"> <td> <p>Ist dir bei den beiden Funktionen im Reducer etwas aufgefallen?<br /> Die <code class="language-plaintext highlighter-rouge">addUserToState</code>-Funktion ist nicht <strong>pure</strong>! In <em>plain Redux</em> sollte dies nicht so gelöst werden, aber mit dem <em>Redux Toolkit</em> geht das in Ordnung, da durch eine integrierte Library die mutierten States in einen vollkommen neuen State umgewandelt werden und somit die Funktion durchaus pure ist!<br /> Ein weitere Vereinfachung für den Anwendeung des Redux Toolkits. Jeahi;)</p> </td> </tr> </tbody> </table></div> <div class="text-center"> <button class="check btn btn-primary" onclick="(function (btn){ var theTable = btn.parentNode.previousElementSibling; var theAnswer = theTable.getElementsByClassName('hint')[0]; theAnswer.classList.toggle('default-hidden'); }(this))"> Tips anzeigen </button> </div> </div> <p>Der <strong>Store</strong> wurde erfolgreich mit einem initialen <code class="language-plaintext highlighter-rouge">login</code> Objekt erweitert. Der nächste Schritt ist das Einbinden der <code class="language-plaintext highlighter-rouge">react-redux</code>-Hooks <code class="language-plaintext highlighter-rouge">useSelector</code> und <code class="language-plaintext highlighter-rouge">useDispatch</code>, woauch immer der State gebraucht oder verändert wird.</p> <div> <div class="table-wrapper"><table> <tbody> <tr> <th style="border-bottom: 1px solid #ddd"> <p>Task</p> </th> </tr> <tr> <td><p>Ersetze den <em>React State</em> für <code class="language-plaintext highlighter-rouge">user</code> und <code class="language-plaintext highlighter-rouge">token</code> in <code class="language-plaintext highlighter-rouge">App.js</code> mit den Values aus dem Redux Store.</p> </td> </tr> <tr class="hint default-hidden" style="color: grey"> <td><p>Benutze die <code class="language-plaintext highlighter-rouge">useSelector</code> und <code class="language-plaintext highlighter-rouge">useDispatch</code> API von <code class="language-plaintext highlighter-rouge">react-redux</code>.</p> <p>Beispiel für <strong><em>Selektieren</em></strong> (Lesen) des Users aus dem Store:</p> <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">((</span><span class="nx">state</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">state</span><span class="p">.</span><span class="nx">login</span><span class="p">.</span><span class="nx">user</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div></div> <p>Ein <strong><em>Dispatch</em></strong> wird folgendermassen initiiert:</p> <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">const</span> <span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">useDispatch</span><span class="p">();</span>
  <span class="p">...</span>

  <span class="c1">// woauch immer eine Änderung auf dem Store durchgeführt werden muss:</span>
  <span class="nx">dispatch</span><span class="p">(&lt;</span><span class="nt">reducerFunction</span><span class="p">&gt;</span>(<span class="si">{</span><span class="p">&lt;</span><span class="nt">actionPayload</span><span class="p">&gt;</span>}))
</code></pre></div></div> </td> </tr> </tbody> </table></div> <div class="text-center"> <button class="check btn btn-primary" onclick="(function (btn){ var theTable = btn.parentNode.previousElementSibling; var theAnswer = theTable.getElementsByClassName('hint')[0]; theAnswer.classList.toggle('default-hidden'); }(this))"> Tips anzeigen </button> </div> </div> <div> <div class="table-wrapper"><table> <tbody> <tr class="solution default-hidden"> <td> <p>Die React-State Methode wurde auskommentiert und wird durch Dispatches und Selektoren ersetzt.</p> <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">isAuthenticated</span><span class="p">,</span> <span class="nx">setIsAuthenticated</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="c1">//const [user, setUser] = useState(JSON.parse(sessionStorage.getItem('user')));</span>
  <span class="c1">//const [token, setToken] = useState(sessionStorage.getItem('token'));</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">pathName</span><span class="p">,</span> <span class="nx">setPathName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
  <span class="kd">let</span> <span class="nx">location</span> <span class="o">=</span> <span class="nx">useLocation</span><span class="p">();</span>

  <span class="kd">const</span> <span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">useDispatch</span><span class="p">();</span>

  <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">((</span><span class="nx">state</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">login</span><span class="p">.</span><span class="nx">user</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">((</span><span class="nx">state</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">login</span><span class="p">.</span><span class="nx">token</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">authenticate</span> <span class="o">=</span> <span class="p">(</span><span class="nx">login</span><span class="p">,</span> <span class="nx">password</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">api</span>
      <span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="nx">login</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(({</span> <span class="nx">token</span><span class="p">,</span> <span class="nx">owner</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">setIsAuthenticated</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="c1">//setToken(token);</span>
        <span class="c1">//setUser(owner);</span>

        <span class="nx">dispatch</span><span class="p">(</span><span class="nx">addUserToState</span><span class="p">({</span> <span class="na">user</span><span class="p">:</span> <span class="nx">owner</span><span class="p">,</span> <span class="nx">token</span> <span class="p">}));</span>

        <span class="nx">sessionStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">,</span> <span class="nx">token</span><span class="p">);</span>
        <span class="nx">sessionStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">user</span><span class="dl">'</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">owner</span><span class="p">));</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="kd">const</span> <span class="nx">signout</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setIsAuthenticated</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="c1">//setToken(undefined);</span>
    <span class="c1">//setUser(undefined);</span>

    <span class="nx">dispatch</span><span class="p">(</span><span class="nx">removeUserFromState</span><span class="p">());</span>

    <span class="nx">sessionStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">sessionStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">user</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">};</span>
  <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div> </td> </tr> </tbody> </table></div> <div class="text-center"> <button class="check btn btn-success" onclick="(function (btn){ var theTable = btn.parentNode.previousElementSibling; var theAnswer = theTable.getElementsByClassName('solution')[0]; theAnswer.classList.toggle('default-hidden'); }(this))"> Lösung </button> </div> </div> <p>Nun bist Du besetens gerüstet, um dich ans Testat zu machen;)</p> <div class="prev-next-area mt-8"> <p class="float-left fs-2">Previous<br/> <a href="/WE3-React/week3/redux.html" title="Redux"> ← Redux </a> </p> <p class="float-right fs-2">Next<br/> <a href="/WE3-React/testat/" title="Redux"> Testat → </a> </p> </div> <div style="clear: both"></div> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright © 2022 Mirko Stocker. This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons A-NC-SA 4.0 International License</a>.</p> </footer> </div> </div> </div> </body> </html>
